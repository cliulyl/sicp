## P145 - [练习 2.95]

### 现象

在[练习 2.94](./exercise_2_94.scm)的代码上，添加下面语句：

``` Scheme
(define P1  (make-polynomial 'x '((2 1) (1 -2) (0 1))))
(define P2  (make-polynomial 'x '((2 11) (0 7))))
(define P3  (make-polynomial 'x '((1 13) (0 5))))

(define Q1 (mul P1 P2))
(define Q2 (mul P1 P3))

(print-poly "gcd(Q1,Q2)" (greatest-common-divisor Q1 Q2))
```
输出为

```
gcd(Q1,Q2)
(polynomial x (2 1458/169) (1 -2916/169) (0 1458/169))
(1458/169*x^2 + (-2916/169)*x + 1458/169)
```

对比 gcd(Q1,Q2) 和 P1 的中缀表达式，有

```
gcd(Q1,Q2): 1458/169*x^2 + (-2916/169)*x + 1458/169
P1:         x^2 + (-2)*x + 1
```
可知。Q1、Q2 求 GCD 的结果，跟 P1 比较显得更复杂，每一项多了 `1458/169` 这个分数。


### 分析原因

为理解这个分数出现的原因，可以在 `gcd-terms` 中打印一些调试信息，输出为。

```
call gcd-terms
a: ((4 11) (3 -22) (2 18) (1 -14) (0 7))
b: ((3 13) (2 -21) (1 3) (0 5))

call gcd-terms
a: ((3 13) (2 -21) (1 3) (0 5))
b: ((2 1458/169) (1 -2916/169) (0 1458/169))

call gcd-terms
a: ((2 1458/169) (1 -2916/169) (0 1458/169))
b: ()
```

其中 

* `((4 11) (3 -22) (2 18) (1 -14) (0 7))` 为 (term-list Q1)
* `((3 13) (2 -21) (1 3) (0 5))` 为 (term-list Q2)

可以见到，调用了三次 gcd-terms。第二次调用时，b 参数就已经出现了分数。而第二次调用时的 b 参数，正是第一次调用时的 

``` Scheme
(remainder-terms a b)
```

为此我们再使用 `div-terms` 函数，打印出 a、b、div 的输出，有

```
a:   ((4 11) (3 -22) (2 18) (1 -14) (0 7))
b:   ((3 13) (2 -21) (1 3) (0 5))
a/b: ((1 11/13) (0 -55/169))
a%b: ((2 1458/169) (1 -2916/169) (0 1458/169))
```
`remainder-terms` 用于求多项式余数。余式是使用 `a - b * (a/b)` 来定义的。商式 `a/b`出现了分数，余式自然也会出现分数。

观察到商式第一项中已出现分数 11/13。分析 `div-terms` 的代码，代码中出现 L1、L2 第一项时

* t1 = (4 11), 表示 order = 4, coeff = 11
* t2 = (3 13), 表示 order = 3, coeff = 13

`div-terms` 有这两行代码，用于求新项的 order 和 coeff

``` Scheme
(new-c (div (coeff t1) (coeff t2)))
(new-o (- (order t1) (order t2)))
```

下面表达式求值过程为
 
``` Scheme
(new-c (div (coeff t1) (coeff t2)))
(new-c (div 11 13))
(new-c (/ 11 13))
(new-c 11/13)
```

于是我们知道了分数出现的原因。在 Scheme 中，两个整数使用 / 来求值，就会得到一个精确的分数(有理数)。

